<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>–ó–¥–æ—Ä–æ–≤–∞—è –ñ–∏–∑–Ω—å ‚Äî –ê–Ω–∞–ª–∏–∑ –µ–¥—ã</title>
  <style>
    :root{
      --bg:#F6F7FB;
      --card:#FFFFFF;
      --text:#0F172A;
      --muted:#64748B;
      --muted2:#94A3B8;
      --line:#E5E7EB;

      --blue:#2563EB;
      --blue-100:#EEF6FF;

      --sand:#FFF8E6; /* –∂–µ–ª—Ç–æ–≤–∞—Ç–∞—è –ø–ª–∞—à–∫–∞ –≤ –º–∞–∫–µ—Ç–µ */
      --sand-line:#F1E7C8;

      --orange:#F97316;
      --orange-100:#FFF1E6;

      --shadow: 0 10px 26px rgba(15, 23, 42, .06);
      --radius: 14px;

      --container: 1120px;
      --font: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Noto Sans", "Helvetica Neue", sans-serif;
    }
    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      font-family:var(--font);
      background:var(--bg);
      color:var(--text);
    }

    /* ===== Header ===== */
    .topbar{
      background:#fff;
      border-bottom:1px solid var(--line);
    }
    .topbar-inner{
      max-width:var(--container);
      margin:0 auto;
      padding:14px 18px 10px;
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:16px;
    }
    .brand{
      display:flex;
      align-items:center;
      gap:10px;
      min-width:260px;
    }
    .logo{
      width:42px;height:42px;
      border-radius:14px;
      display:grid;place-items:center;
      background:linear-gradient(180deg,#34D399,#22C55E);
      box-shadow:0 6px 14px rgba(34,197,94,.18);
      flex:0 0 auto;
    }
    .logo svg{ width:22px;height:22px; }

    .brand-text{
      display:flex;
      flex-direction:column;
      gap:2px;
      line-height:1.05;
    }
    .brand-title{
      font-weight:900;
      font-size:18px;
    }
    .brand-sub{
      font-size:12px;
      color:var(--muted);
    }

    .nav{
      display:flex;
      align-items:center;
      gap:22px;
      padding-top:6px;
      flex-wrap:wrap;
    }
    .nav a{
      display:flex;
      align-items:center;
      gap:8px;
      color:#334155;
      text-decoration:none;
      font-size:14px;
      padding:8px 10px;
      border-radius:10px;
      transition:.15s ease;
      position:relative;
    }
    .nav a:hover{ background:#F1F5F9; }
    .nav a.active{
      color:var(--blue);
      font-weight:800;
    }
    .nav a.active::after{
      content:"";
      position:absolute;
      left:10px;
      right:10px;
      bottom:-10px;
      height:3px;
      border-radius:999px;
      background:var(--blue);
    }
    .nav svg{ width:16px;height:16px; }

    /* ===== Main ===== */
    .container{
      max-width:var(--container);
      margin:0 auto;
      padding:18px 18px 44px;
    }

    /* Hero (yellow banner) */
    .hero{
      background:linear-gradient(90deg, #FFF8E6 0%, #FFF8E6 55%, #FFF9EA 100%);
      border:1px solid #F1E7C8;
      border-radius:18px;
      padding:26px 26px;
      box-shadow:0 10px 22px rgba(15,23,42,.04);
      margin-top:12px;
    }
    .hero h1{
      margin:0 0 10px;
      font-size:34px;
      letter-spacing:-.6px;
    }
    .hero p{
      margin:0;
      color:#475569;
      max-width:900px;
      line-height:1.55;
      font-size:14px;
    }

    /* Two cards row */
    .row{
      margin-top:18px;
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:18px;
    }
    .card{
      background:#fff;
      border:1px solid var(--line);
      border-radius:16px;
      box-shadow:var(--shadow);
      padding:18px;
      min-height: 270px;
    }
    .card h3{
      margin:0 0 6px;
      font-size:15px;
      font-weight:900;
    }
    .sub{
      margin:0 0 14px;
      color:var(--muted);
      font-size:14px;
    }

    /* Upload area */
    .drop{
      border:2px solid #E5E7EB;
      border-radius:12px;
      background:#fff;
      height: 190px;
      display:grid;
      place-items:center;
      padding:18px;
      position:relative;
      overflow:hidden;
    }
    .drop.is-drag{
      border-color: rgba(249,115,22,.55);
      box-shadow: 0 0 0 4px rgba(249,115,22,.12);
      background: #FFFBF5;
    }
    .drop-inner{
      text-align:center;
      display:flex;
      flex-direction:column;
      align-items:center;
      gap:10px;
      color:var(--muted);
      max-width: 320px;
    }
    .cam-ico{
      width:54px;height:54px;
      border-radius:16px;
      display:grid;place-items:center;
      color:#9CA3AF;
    }
    .cam-ico svg{ width:54px;height:54px; }
    .upload-action{
      display:flex;
      flex-direction:column;
      gap:2px;
      align-items:center;
    }
    .link{
      color: var(--orange);
      font-weight:900;
      cursor:pointer;
      user-select:none;
    }
    .small{
      font-size:12px;
      color:var(--muted2);
      margin-top:2px;
    }

    /* Preview inside upload */
    .preview{
      position:absolute;
      inset:0;
      display:none;
      background:#fff;
    }
    .preview img{
      width:100%;
      height:100%;
      object-fit:cover;
      display:block;
    }
    .preview .badge{
      position:absolute;
      left:12px;
      top:12px;
      background:rgba(15,23,42,.78);
      color:#fff;
      font-size:12px;
      font-weight:800;
      padding:6px 10px;
      border-radius:999px;
      backdrop-filter: blur(6px);
    }
    .preview .reset{
      position:absolute;
      right:12px;
      top:12px;
      width:34px;height:34px;
      border-radius:10px;
      border:1px solid rgba(255,255,255,.25);
      background:rgba(15,23,42,.65);
      display:grid;
      place-items:center;
      cursor:pointer;
    }
    .preview .reset svg{ width:18px;height:18px; }

    /* Results area */
    .results-center{
      height: 210px;
      display:grid;
      place-items:center;
      color:var(--muted2);
      text-align:center;
      border-radius:12px;
    }
    .results-center .cam-ico{ color:#9CA3AF; }
    .results-center .text{
      margin-top:8px;
      font-size:14px;
      font-weight:700;
      color:#94A3B8;
    }

    .results{
      display:none;
      margin-top:6px;
    }
    .res-line{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      margin: 8px 0 12px;
    }
    .pill{
      display:inline-flex;
      align-items:center;
      gap:8px;
      border-radius:999px;
      padding:7px 10px;
      font-size:12px;
      font-weight:900;
      border:1px solid rgba(37,99,235,.18);
      background: rgba(37,99,235,.10);
      color:#1D4ED8;
    }
    .pill.orange{
      border-color: rgba(249,115,22,.18);
      background: rgba(249,115,22,.10);
      color:#C2410C;
    }
    .pill.green{
      border-color: rgba(22,163,74,.18);
      background: rgba(22,163,74,.10);
      color:#15803D;
    }

    .block{
      border-top:1px solid #F1F5F9;
      padding-top:12px;
      margin-top:10px;
    }
    .block-title{
      font-weight:900;
      font-size:13px;
      margin:0 0 6px;
    }
    .ul{
      margin:0;
      padding-left:18px;
      color:#334155;
      font-size:13px;
      line-height:1.6;
    }
    .ul li{ margin:4px 0; }

    .note{
      margin-top:10px;
      font-size:12px;
      color:var(--muted);
      line-height:1.5;
    }

    /* Bottom feature cards */
    .features{
      margin-top:18px;
      display:grid;
      grid-template-columns: repeat(3, 1fr);
      gap:18px;
    }
    .feat{
      background:#fff;
      border:1px solid var(--line);
      border-radius:14px;
      box-shadow:var(--shadow);
      padding:16px 16px;
      min-height: 92px;
      display:flex;
      gap:12px;
      align-items:flex-start;
    }
    .feat .ico{
      width:28px;height:28px;
      display:grid;place-items:center;
      color:#334155;
      flex:0 0 auto;
      margin-top:2px;
    }
    .feat h4{
      margin:0 0 6px;
      font-size:14px;
      font-weight:900;
    }
    .feat p{
      margin:0;
      color:var(--muted);
      font-size:13px;
      line-height:1.45;
    }

    /* Footer */
    .footer{
      margin-top:28px;
      border-top:1px solid var(--line);
      background:#fff;
    }
    .footer-inner{
      max-width:var(--container);
      margin:0 auto;
      padding:14px 18px;
      text-align:center;
      color:var(--muted);
      font-size:12px;
    }

    @media (max-width: 1050px){
      .topbar-inner{ flex-direction:column; align-items:flex-start; }
      .nav a.active::after{ display:none; }
      .row{ grid-template-columns: 1fr; }
      .features{ grid-template-columns: 1fr; }
    }
  </style>
</head>

<body>
  <!-- HEADER -->
  <header class="topbar">
    <div class="topbar-inner">
      <div class="brand">
        <div class="logo" aria-hidden="true">
          <!-- salad bowl -->
          <svg viewBox="0 0 24 24" fill="none">
            <path d="M4 13c.7 5.2 4.1 8 8 8s7.3-2.8 8-8H4Z" fill="#fff" opacity=".95"/>
            <path d="M6.2 11.6c1.2-1.9 3.4-3.1 5.8-3.1 2.3 0 4.5 1.2 5.7 3.1" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
            <path d="M8.2 8.2c.7-1.7 2.1-3 3.8-3.7" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
          </svg>
        </div>
        <div class="brand-text">
          <div class="brand-title">Batyr Sport</div>
          <div class="brand-sub">AI –ø–æ–º–æ—â–Ω–∏–∫ –ø–æ –ø–∏—Ç–∞–Ω–∏—é</div>
        </div>
      </div>

      <nav class="nav" aria-label="–ù–∞–≤–∏–≥–∞—Ü–∏—è">
        <a href="index.html">
          <!-- home -->
          <svg viewBox="0 0 24 24" fill="none">
            <path d="M3 10.5 12 3l9 7.5V21a1 1 0 0 1-1 1h-5v-7H9v7H4a1 1 0 0 1-1-1v-10.5Z" stroke="currentColor" stroke-width="2" stroke-linejoin="round"/>
          </svg>
          –ì–ª–∞–≤–Ω–∞—è
        </a>

        <a href="chat.html">
          <!-- chat -->
          <svg viewBox="0 0 24 24" fill="none">
            <path d="M21 12a7 7 0 0 1-7 7H8l-5 3 1.6-4.8A7 7 0 1 1 21 12Z" stroke="currentColor" stroke-width="2" stroke-linejoin="round"/>
          </svg>
          AI –ß–∞—Ç-–±–æ—Ç
        </a>

        <a class="active" href="#">
          <!-- camera/doc -->
          <svg viewBox="0 0 24 24" fill="none">
            <path d="M4 19V5a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v14" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            <path d="M8 11h8M8 15h6M8 7h8" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          </svg>
          –ê–Ω–∞–ª–∏–∑ –µ–¥—ã
        </a>

        <a href="profile.html">
          <!-- profile -->
          <svg viewBox="0 0 24 24" fill="none">
            <path d="M20 21a8 8 0 1 0-16 0" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            <path d="M12 13a4 4 0 1 0 0-8 4 4 0 0 0 0 8Z" stroke="currentColor" stroke-width="2"/>
          </svg>
          –ü—Ä–æ—Ñ–∏–ª—å
        </a>
      </nav>
    </div>
  </header>

  <!-- MAIN -->
  <main class="container">
    <section class="hero">
      <h1>–ê–Ω–∞–ª–∏–∑ –µ–¥—ã –ø–æ —Ñ–æ—Ç–æ</h1>
      <p>
        –ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—é –±–ª—é–¥–∞, –∏ AI –æ–ø—Ä–µ–¥–µ–ª–∏—Ç –∫–∞–ª–æ—Ä–∏–π–Ω–æ—Å—Ç—å, —Å–æ—Å—Ç–∞–≤ –∏ –¥–∞—Å—Ç –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ —Å —É—á–µ—Ç–æ–º –≤–∞—à–µ–≥–æ –∑–¥–æ—Ä–æ–≤—å—è<br>
        –∏ —Ä–µ–ª–∏–≥–∏–æ–∑–Ω—ã—Ö –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–π
      </p>
    </section>

    <section class="row">
      <!-- Upload card -->
      <div class="card">
        <h3>–ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–æ—Ç–æ –±–ª—é–¥–∞</h3>
        <p class="sub">–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è —Ñ–æ—Ä–º–∞—Ç—ã: JPG, PNG, HEIC</p>

        <div id="drop" class="drop" role="button" tabindex="0" aria-label="–ó–æ–Ω–∞ –∑–∞–≥—Ä—É–∑–∫–∏">
          <div class="drop-inner">
            <div class="cam-ico" aria-hidden="true">
              <svg viewBox="0 0 64 64" fill="none">
                <path d="M22 18h7l3-4h10l3 4h7a6 6 0 0 1 6 6v24a6 6 0 0 1-6 6H22a6 6 0 0 1-6-6V24a6 6 0 0 1 6-6Z" stroke="#9CA3AF" stroke-width="4" stroke-linejoin="round"/>
                <path d="M32 44a10 10 0 1 0 0-20 10 10 0 0 0 0 20Z" stroke="#9CA3AF" stroke-width="4"/>
              </svg>
            </div>

            <div class="upload-action">
              <div>
                <span id="pick" class="link">–ù–∞–∂–º–∏—Ç–µ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏</span>
              </div>
              <div class="small">–∏–ª–∏ –ø–µ—Ä–µ—Ç–∞—â–∏—Ç–µ —Ñ–∞–π–ª —Å—é–¥–∞</div>
            </div>
          </div>

          <div id="preview" class="preview">
            <span class="badge" id="fileName">–§–æ—Ç–æ</span>
            <button class="reset" id="resetBtn" type="button" aria-label="–°–±—Ä–æ—Å–∏—Ç—å">
              <svg viewBox="0 0 24 24" fill="none">
                <path d="M18 6 6 18M6 6l12 12" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
              </svg>
            </button>
            <img id="previewImg" alt="preview">
          </div>

          <input id="file" type="file" accept="image/*" hidden>
        </div>
      </div>

      <!-- Results card -->
      <div class="card">
        <h3>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞</h3>
        <p class="sub">AI –∞–Ω–∞–ª–∏–∑ —Å —É—á–µ—Ç–æ–º –≤–∞—à–∏—Ö –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–π</p>

        <div id="emptyResults" class="results-center">
          <div>
            <div class="cam-ico" aria-hidden="true">
              <svg viewBox="0 0 64 64" fill="none">
                <path d="M22 18h7l3-4h10l3 4h7a6 6 0 0 1 6 6v24a6 6 0 0 1-6 6H22a6 6 0 0 1-6-6V24a6 6 0 0 1 6-6Z" stroke="#9CA3AF" stroke-width="4" stroke-linejoin="round"/>
                <path d="M32 44a10 10 0 1 0 0-20 10 10 0 0 0 0 20Z" stroke="#9CA3AF" stroke-width="4"/>
              </svg>
            </div>
            <div class="text">–ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–æ—Ç–æ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞</div>
          </div>
        </div>

        <div id="results" class="results">
          <div class="res-line" id="pills"></div>

          <div class="block">
            <div class="block-title">–ß—Ç–æ –Ω–∞ —Ñ–æ—Ç–æ</div>
            <ul class="ul" id="ingredients"></ul>
          </div>

          <div class="block">
            <div class="block-title">–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏</div>
            <ul class="ul" id="recs"></ul>
          </div>

          <div class="note" id="note"></div>
        </div>
      </div>
    </section>

    <!-- Bottom features -->
    <section class="features">
      <div class="feat">
        <div class="ico" aria-hidden="true">üïå</div>
        <div>
          <h4>–†–µ–ª–∏–≥–∏–æ–∑–Ω—ã–µ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è</h4>
          <p>–£—á–∏—Ç—ã–≤–∞–µ–º —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è —Ö–∞–ª—è–ª—å, –∫–æ—à–µ—Ä –∏ –¥—Ä—É–≥–∏–µ —Ä–µ–ª–∏–≥–∏–æ–∑–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è</p>
        </div>
      </div>

      <div class="feat">
        <div class="ico" aria-hidden="true">üè•</div>
        <div>
          <h4>–°–æ—Å—Ç–æ—è–Ω–∏–µ –∑–¥–æ—Ä–æ–≤—å—è</h4>
          <p>–ê–Ω–∞–ª–∏–∑ —Å —É—á–µ—Ç–æ–º –¥–∏–∞–±–µ—Ç–∞, –∞–ª–ª–µ—Ä–≥–∏–π –∏ –¥—Ä—É–≥–∏—Ö –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π</p>
        </div>
      </div>

      <div class="feat">
        <div class="ico" aria-hidden="true">üìä</div>
        <div>
          <h4>–¢–æ—á–Ω—ã–π –∞–Ω–∞–ª–∏–∑</h4>
          <p>AI –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Å–æ—Å—Ç–∞–≤ –±–ª—é–¥–∞ –∏ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç –ø–∏—â–µ–≤—É—é —Ü–µ–Ω–Ω–æ—Å—Ç—å</p>
        </div>
      </div>
    </section>
  </main>

  <footer class="footer">
    <div class="footer-inner">
      ¬© 2026 –ó–¥–æ—Ä–æ–≤–∞—è –ñ–∏–∑–Ω—å. AI-powered –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è –∑–¥–æ—Ä–æ–≤–æ–≥–æ –ø–∏—Ç–∞–Ω–∏—è –∏ –æ–±—Ä–∞–∑–∞ –∂–∏–∑–Ω–∏
    </div>
  </footer>

  <script>
    // ====== –ù–∞—Å—Ç—Ä–æ–π–∫–∞: –∫—É–¥–∞ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Ñ–æ—Ç–æ ======
    // –ï—Å–ª–∏ –µ—Å—Ç—å Flask endpoint, –ø–æ—Å—Ç–∞–≤—å –µ–≥–æ —Å—é–¥–∞, –Ω–∞–ø—Ä–∏–º–µ—Ä "/analyze-food"
    const API_URL = "/analyze-food"; // –º–æ–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ "/predict" –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—à—å —Ç–æ—Ç –∂–µ endpoint

    const drop = document.getElementById("drop");
    const fileInput = document.getElementById("file");
    const pick = document.getElementById("pick");
    const preview = document.getElementById("preview");
    const previewImg = document.getElementById("previewImg");
    const fileName = document.getElementById("fileName");
    const resetBtn = document.getElementById("resetBtn");

    const emptyResults = document.getElementById("emptyResults");
    const results = document.getElementById("results");
    const pills = document.getElementById("pills");
    const ingredients = document.getElementById("ingredients");
    const recs = document.getElementById("recs");
    const note = document.getElementById("note");

    let currentFile = null;

    function setDrag(state){
      drop.classList.toggle("is-drag", state);
    }

    function clearResults(){
      pills.innerHTML = "";
      ingredients.innerHTML = "";
      recs.innerHTML = "";
      note.textContent = "";
      results.style.display = "none";
      emptyResults.style.display = "grid";
    }

    function showPreview(file){
      currentFile = file;
      const url = URL.createObjectURL(file);
      previewImg.src = url;
      preview.style.display = "block";
      fileName.textContent = file.name.length > 22 ? file.name.slice(0, 22) + "‚Ä¶" : file.name;
    }

    function hidePreview(){
      currentFile = null;
      preview.style.display = "none";
      previewImg.src = "";
      fileInput.value = "";
      clearResults();
    }

    function pill(text, kind="blue"){
      const cls = kind === "green" ? "pill green" : kind === "orange" ? "pill orange" : "pill";
      return `<span class="${cls}">${text}</span>`;
    }

    function li(text){ return `<li>${text}</li>`; }

    // ====== –î–µ–º–æ-–∞–Ω–∞–ª–∏–∑ (–µ—Å–ª–∏ –±–µ–∫–µ–Ω–¥–∞ –Ω–µ—Ç) ======
    function fakeAnalyze(){
      // –ø—Ä–æ—Å—Ç–æ –ø—Ä–∏–º–µ—Ä, —á—Ç–æ–±—ã UI ‚Äú–æ–∂–∏–ª‚Äù
      const demo = {
        dish: "–°–∞–ª–∞—Ç / –±–ª—é–¥–æ —Å –æ–≤–æ—â–∞–º–∏",
        calories: 420,
        protein_g: 18,
        carbs_g: 45,
        fat_g: 14,
        ingredients: [
          "–û–≤–æ—â–∏ (–ø–æ–º–∏–¥–æ—Ä—ã, –æ–≥—É—Ä—Ü—ã)",
          "–ë–µ–ª–∫–æ–≤—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç (–∫—É—Ä–∏—Ü–∞/—Å—ã—Ä/—è–π—Ü–æ) ‚Äî –≤–æ–∑–º–æ–∂–Ω–æ",
          "–°–æ—É—Å –∏–ª–∏ –º–∞—Å–ª–æ (–æ–ª–∏–≤–∫–æ–≤–æ–µ/—Ä–∞—Å—Ç–∏—Ç–µ–ª—å–Ω–æ–µ)"
        ],
        recs: [
          "–ï—Å–ª–∏ –µ—Å—Ç—å —Ü–µ–ª—å –ø–æ—Ö—É–¥–µ–Ω–∏–µ ‚Äî —É–º–µ–Ω—å—à–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ—É—Å–∞/–º–∞—Å–ª–∞",
          "–î–æ–±–∞–≤—å—Ç–µ –±–æ–ª—å—à–µ –±–µ–ª–∫–∞ (–∫—É—Ä–∏—Ü–∞/—Ä—ã–±–∞/–±–æ–±–æ–≤—ã–µ) –¥–ª—è —Å—ã—Ç–æ—Å—Ç–∏",
          "–ü—Ä–∏ –¥–∏–∞–±–µ—Ç–µ ‚Äî —Å–ª–µ–¥–∏—Ç–µ –∑–∞ –ø–æ—Ä—Ü–∏–µ–π —É–≥–ª–µ–≤–æ–¥–æ–≤ –∏ —Å–æ—É—Å–∞–º–∏"
        ],
        note: "–î–ª—è –±–æ–ª–µ–µ —Ç–æ—á–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ —Å–¥–µ–ª–∞–π—Ç–µ —Ñ–æ—Ç–æ –±–ª–∏–∂–µ –∏ –ø—Ä–∏ —Ö–æ—Ä–æ—à–µ–º –æ—Å–≤–µ—â–µ–Ω–∏–∏."
      };
      return demo;
    }

    async function analyze(file){
      // –ï—Å–ª–∏ endpoint –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç ‚Äî —É–ø–∞–¥—ë—Ç, —Ç–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ–º demo
      const fd = new FormData();
      fd.append("image", file);

      // –¢–£–¢ –º–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
      // fd.append("diet", "halal");
      // fd.append("health", "diabetes");

      try{
        const r = await fetch(API_URL, { method:"POST", body: fd });
        if(!r.ok) throw new Error("Bad response " + r.status);
        return await r.json();
      }catch(e){
        // fallback: –¥–µ–º–æ
        return fakeAnalyze();
      }
    }

    async function renderAnalysis(file){
      clearResults(); // —Å–±—Ä–æ—Å
      // –ø–æ–∫–∞–∑—ã–≤–∞–µ–º ‚Äú–∑–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–æ—Ç–æ‚Äù –ø–æ–∫–∞ –Ω–µ –≥–æ—Ç–æ–≤–æ? ‚Äî –ª—É—á—à–µ —Å—Ä–∞–∑—É –ø–æ–∫–∞–∑–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è
      emptyResults.querySelector(".text").textContent = "–ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —Ñ–æ—Ç–æ‚Ä¶";

      const data = await analyze(file);

      // –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º: –ø–æ–¥–¥–µ—Ä–∂–∏–º –∏ demo, –∏ –≤–æ–∑–º–æ–∂–Ω—ã–π backend json
      const dish = data.dish || data.name || "–ë–ª—é–¥–æ";
      const calories = data.calories ?? data.kcal ?? 0;
      const protein = data.protein_g ?? data.protein ?? 0;
      const carbs = data.carbs_g ?? data.carbs ?? 0;
      const fat = data.fat_g ?? data.fat ?? 0;

      const ing = data.ingredients || data.composition || [];
      const rec = data.recs || data.recommendations || [];
      const n = data.note || data.notes || "";

      pills.innerHTML =
        pill(dish, "orange") +
        pill(`${calories} –∫–∫–∞–ª`, "green") +
        pill(`–ë: ${protein}–≥`) +
        pill(`–£: ${carbs}–≥`) +
        pill(`–ñ: ${fat}–≥`);

      ingredients.innerHTML = ing.length ? ing.map(li).join("") : li("–ù–µ —É–¥–∞–ª–æ—Å—å –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Å–æ—Å—Ç–∞–≤. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –¥—Ä—É–≥–æ–µ —Ñ–æ—Ç–æ.");
      recs.innerHTML = rec.length ? rec.map(li).join("") : li("–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –ø–æ–∫–∞ –Ω–µ—Ç. –£—Ç–æ—á–Ω–∏—Ç–µ —Ü–µ–ª–∏ –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è.");

      note.textContent = n;

      emptyResults.style.display = "none";
      results.style.display = "block";
    }

    // ====== –°–æ–±—ã—Ç–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ ======
    pick.addEventListener("click", () => fileInput.click());

    drop.addEventListener("click", (e) => {
      // –µ—Å–ª–∏ –∫–ª–∏–∫ –ø–æ –∫—Ä–µ—Å—Ç—É ‚Äî –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞—Ç—å –≤—ã–±–æ—Ä —Ñ–∞–π–ª–∞
      if (e.target.closest("#resetBtn")) return;
      fileInput.click();
    });

    drop.addEventListener("keydown", (e) => {
      if(e.key === "Enter" || e.key === " "){
        e.preventDefault();
        fileInput.click();
      }
    });

    fileInput.addEventListener("change", async () => {
      const file = fileInput.files?.[0];
      if(!file) return;
      showPreview(file);
      await renderAnalysis(file);
    });

    resetBtn.addEventListener("click", (e) => {
      e.stopPropagation();
      hidePreview();
      emptyResults.querySelector(".text").textContent = "–ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–æ—Ç–æ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞";
    });

    // Drag & Drop
    ["dragenter","dragover"].forEach(evt => {
      drop.addEventListener(evt, (e) => {
        e.preventDefault();
        e.stopPropagation();
        setDrag(true);
      });
    });
    ["dragleave","drop"].forEach(evt => {
      drop.addEventListener(evt, (e) => {
        e.preventDefault();
        e.stopPropagation();
        setDrag(false);
      });
    });

    drop.addEventListener("drop", async (e) => {
      const file = e.dataTransfer?.files?.[0];
      if(!file) return;
      fileInput.files = e.dataTransfer.files; // —á—Ç–æ–±—ã change –ª–æ–≥–∏–∫–∞ —Å–æ–≤–ø–∞–ª–∞
      showPreview(file);
      await renderAnalysis(file);
    });

    // initial state
    clearResults();
  </script>
</body>
</html>
